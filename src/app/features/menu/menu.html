<!-- menu.html -->
<app-splash-screen 
  *ngIf="isSplashing" 
  (animationFinished)="onSplashFinished()">
</app-splash-screen>

<div class="menu-wrapper" *ngIf="publicData$ | async as data">
  <div class="logo-container">
    <img src="assets/images/logo.png" alt="Spritzeria Barberini Logo" class="logo-image">
  </div>
  <app-language-switcher></app-language-switcher>

  <div class="welcome-section">
    <div class="welcome-text">
      <p>{{ 'ui.welcome_p1' | translate }}</p>
      <p>{{ 'ui.welcome_p2' | translate }}</p>
      <span class="welcome-brand">Spritzeria Barberini</span>
    </div>
  </div>

  <!-- ✅ Usa il metodo helper getLocalizedText -->
  <div *ngFor="let category of data.categories || []; trackBy: trackByCategoryId" class="category-section">
    
    <h2 class="category-title">{{ getLocalizedText(category.name, 'Categoria') }}</h2>
    
    <div *ngFor="let item of category.items || []; trackBy: trackByItemId" class="menu-item">
      
      <div class="item-header">
        <span class="item-name">{{ getLocalizedText(item.name, 'Articolo') }}</span>
        @if(!item.disponibile) {
          <span class="item-price">Non Disponibile</span>
        }
        @else {
          <span class="item-price">{{ item.price | currency:'EUR' }}</span>
        }
      </div>
      
      <!-- ✅ Usa il metodo helper -->
      <p class="item-description" *ngIf="getLocalizedText(item.description)">
        {{ getLocalizedText(item.description) }}
      </p>

      <!-- ✅ Usa il metodo helper -->
      <p class="item-ingredients" *ngIf="getLocalizedText(item.ingredients)">
        <span class="ingredients-label">{{ 'ui.ingredients_label' | translate }}:</span>
        {{ getLocalizedText(item.ingredients) }}
      </p>

      <div class="item-info">
        <span *ngIf="item.frozen" class="frozen-item">*{{ 'ui.frozen' | translate }}</span>
        
        <span *ngIf="item.allergens && item.allergens.length > 0">
          {{ 'ui.allergens_label' | translate }}: 
          {{ getAllergenNumbers(item.allergens) }} 
        </span>
      </div>

    </div>
  </div>

  <!-- ✅ Usa il metodo helper -->
  <div class="allergen-legend" *ngIf="data.allergens && data.allergens.length > 0">
    
    <h3 class="legend-title">{{ 'ui.allergens_title' | translate }}</h3>
    
    <ul class="legend-list">
      <li *ngFor="let allergen of data.allergens; trackBy: trackByAllergenId" class="legend-item">
        <span class="allergen-number">{{ allergen.number }}</span>
        <span class="allergen-name">{{ getLocalizedText(allergen.name, 'Allergene') }}</span>
      </li>
    </ul>
  </div>

  <footer class="footer-social">
    <a href="https://www.instagram.com/spritzeriabarberini" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
      <fa-icon [icon]="faInstagram"></fa-icon>
    </a>
    <a href="https://twitter.com/HotelBarberini" target="_blank" rel="noopener noreferrer" aria-label="Twitter">
      <fa-icon [icon]="faTwitter"></fa-icon>
    </a>
    <a href="https://www.facebook.com/hotelbarberiniRoma" target="_blank" rel="noopener noreferrer" aria-label="Facebook">
      <fa-icon [icon]="faFacebook"></fa-icon>
    </a>
  </footer>

  <div class="developer-credit">
    Sviluppato da 
    <a href="https://www.macwelltubale.it" target="_blank" rel="noopener noreferrer">
      Macwell Tubale
    </a>
  </div>
</div>

<button (click)="scrollToTop()" 
        class="scroll-to-top" 
        [class.show]="showScrollButton"
        aria-label="Torna su">
  <fa-icon [icon]="faArrowUp"></fa-icon>
</button>
